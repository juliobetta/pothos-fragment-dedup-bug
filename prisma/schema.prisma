generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["relationJoins"]
}

generator pothos {
  provider = "prisma-pothos-types"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Simple parent model
model Property {
  id      String   @id @default(cuid())
  name    String
  metrics Metric[]
}

// Child with composite unique key (triggers the bug)
model Metric {
  propertyId String   @map("property_id")
  endDate    DateTime @map("end_date") @db.Date
  month      Int
  fieldA     Int      @map("field_a")  // Fragment 1 requests this
  fieldB     Int      @map("field_b")  // Both fragments request this
  fieldC     Int      @map("field_c")  // Fragment 2 requests this

  property Property @relation(fields: [propertyId], references: [id])

  @@unique([propertyId, endDate])
}
